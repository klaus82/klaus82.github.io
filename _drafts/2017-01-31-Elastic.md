---
layout: post
title: Relationships into Elasticsearch
excerpt: ""
categories: [database]
comments: true
image: 
  feature: http://cdn.images.express.co.uk/img/dynamic/130/590x/Mountains-625882.jpg
---

Elasticsearch is a distibuited real time search and analytics engine. Into this system every information is stored like a document.
Int this way we can model the word in a flat way. But into the world, relationships are fundamentals.
So how we can menage relationships into Elasticsearch?
We have four ways:
* Application side-joins
* Data denormalization
* Nested objects
* Parent/Child relationships

# Application side joins
It's possible to emulate the joins on application side.
For instance, imagine we are indexing user and forum posts. In the relattional world we coauld do something like this:

{% highlight raw %}
PUT /my_forum/users/1
{
    "name"  : "Paolo Rossi",
    "email" : "paol.rossi@mail.it",
    "dob"   : "1982/11/20"
}
{% endhighlight %}

{% highlight raw %}
PUT /my_forum/posts/1
{
    "title" : "My post",
    "body"  : "this is my first post",
    "user"  : "1"
}
{% endhighlight %}

Finding posts by user Paolo is necessary to search "Paolo" into users to find theirs ID, and then pass the id into query to find posts.


# Data denormalition
For who came from sql word this is like braking the rules... having redundant copies of data in each document to get the best search performace.
This is optimal if you are sure that your data don't change frequently. On the other side, will be necessary to update the same imnformation in a lot of points. 
Talk about the atomic problems

# Nested objects
To avoid the concurrency problems, that we have denormalizing data, it's possoble to store related objects into a single document.

# Parent/Child relationships
Da indagare e studiare